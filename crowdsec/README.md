# Crowdsec

#### Динамическое увеличение продолжительности бана


Для динамического увеличения продолжительности бана угрозы обнаружаемой crowdsec необходимо изменить в файле profiles.yaml строку параметра:

```
duration_expr: "Sprintf('%dh', (GetDecisionsCount(Alert.GetValue()) + 1) * 8)"
```
означает следующее:

GetDecisionsCount(Alert.GetValue()) — это функция, которая возвращает количество предыдущих решений (банов) для данного источника (например, IP-адреса).
+ 1 — добавляет 1 к количеству предыдущих решений, чтобы учитывать текущее решение.
* 8 — умножает общее количество решений на 8, что означает, что время бана будет увеличиваться на 8 часа за каждое предыдущее решение.
Sprintf('%dh', ...) — форматирует результат в строку, представляющую количество часов.

#### Автоматическое обновление баз

```
crontab -e
```

Выбираем пункт 1 и вставляем в конец файла строку:

a. Если Crowdsec установлен вручную
```
* 3 * * * cscli hub update && cscli hub upgrade 
```
b. Если Crowdsec установлен через Docker контейнер
```
* 3 * * * docker exec crowdsec cscli hub update && docker exec crowdsec cscli hub upgrade
```




